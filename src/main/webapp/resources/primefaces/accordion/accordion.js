PrimeFaces.widget.AccordionPanel=PrimeFaces.widget.BaseWidget.extend({init:function(a){this._super(a);this.stateHolder=$(this.jqId+"_active");this.headers=this.jq.children(".ui-accordion-header");this.panels=this.jq.children(".ui-accordion-content");this.cfg.rtl=this.jq.hasClass("ui-accordion-rtl");this.cfg.expandedIcon="ui-icon-triangle-1-s";this.cfg.collapsedIcon=this.cfg.rtl?"ui-icon-triangle-1-w":"ui-icon-triangle-1-e";this.initActive();this.bindEvents();if(this.cfg.dynamic&&this.cfg.cache){this.markLoadedPanels()}},initActive:function(){if(this.cfg.multiple){var a=this.stateHolder.val().split(",");for(var b=0;b<a.length;b++){a[b]=parseInt(a[b])}this.cfg.active=a}else{this.cfg.active=parseInt(this.stateHolder.val())}},bindEvents:function(){var a=this;this.headers.mouseover(function(){var b=$(this);if(!b.hasClass("ui-state-active")&&!b.hasClass("ui-state-disabled")){b.addClass("ui-state-hover")}}).mouseout(function(){var b=$(this);if(!b.hasClass("ui-state-active")&&!b.hasClass("ui-state-disabled")){b.removeClass("ui-state-hover")}}).click(function(d){var c=$(this);if(!c.hasClass("ui-state-disabled")){var b=c.index()/2;if(c.hasClass("ui-state-active")){a.unselect(b)}else{a.select(b);$(this).trigger("focus.accordion")}}d.preventDefault()});this.bindKeyEvents()},bindKeyEvents:function(){this.headers.on("focus.accordion",function(){$(this).addClass("ui-tabs-outline")}).on("blur.accordion",function(){$(this).removeClass("ui-tabs-outline")}).on("keydown.accordion",function(c){var b=$.ui.keyCode,a=c.which;if(a===b.SPACE||a===b.ENTER||a===b.NUMPAD_ENTER){$(this).trigger("click");c.preventDefault()}})},markLoadedPanels:function(){if(this.cfg.multiple){for(var a=0;a<this.cfg.active.length;a++){if(this.cfg.active[a]>=0){this.markAsLoaded(this.panels.eq(this.cfg.active[a]))}}}else{if(this.cfg.active>=0){this.markAsLoaded(this.panels.eq(this.cfg.active))}}},select:function(c){var b=this.panels.eq(c);if(this.cfg.onTabChange){var a=this.cfg.onTabChange.call(this,b);if(a===false){return false}}var d=this.cfg.dynamic&&!this.isLoaded(b);if(this.cfg.multiple){this.addToSelection(c)}else{this.cfg.active=c}this.saveState();if(d){this.loadDynamicTab(b)}else{if(this.cfg.controlled){if(this.hasBehavior("tabChange")){this.fireTabChangeEvent(b)}}else{this.show(b);if(this.hasBehavior("tabChange")){this.fireTabChangeEvent(b)}}}return true},unselect:function(a){if(this.cfg.controlled){if(this.hasBehavior("tabClose")){this.fireTabCloseEvent(a)}}else{this.hide(a);if(this.hasBehavior("tabClose")){this.fireTabCloseEvent(a)}}},show:function(c){var b=this;if(!this.cfg.multiple){var d=this.headers.filter(".ui-state-active");d.children(".ui-icon").removeClass(this.cfg.expandedIcon).addClass(this.cfg.collapsedIcon);d.attr("aria-selected",false);d.attr("aria-expanded",false).removeClass("ui-state-active ui-corner-top").addClass("ui-corner-all").next().attr("aria-hidden",true).slideUp(function(){if(b.cfg.onTabClose){b.cfg.onTabClose.call(b,c)}})}var a=c.prev();a.attr("aria-selected",true);a.attr("aria-expanded",true).addClass("ui-state-active ui-corner-top").removeClass("ui-state-hover ui-corner-all").children(".ui-icon").removeClass(this.cfg.collapsedIcon).addClass(this.cfg.expandedIcon);c.attr("aria-hidden",false).slideDown("normal",function(){b.postTabShow(c)})},hide:function(c){var a=this,b=this.panels.eq(c),d=b.prev();d.attr("aria-selected",false);d.attr("aria-expanded",false).children(".ui-icon").removeClass(this.cfg.expandedIcon).addClass(this.cfg.collapsedIcon);d.removeClass("ui-state-active ui-corner-top").addClass("ui-corner-all");b.attr("aria-hidden",true).slideUp(function(){if(a.cfg.onTabClose){a.cfg.onTabClose.call(a,b)}});this.removeFromSelection(c);this.saveState()},loadDynamicTab:function(a){var c=this,b={source:this.id,process:this.id,update:this.id,params:[{name:this.id+"_contentLoad",value:true},{name:this.id+"_newTab",value:a.attr("id")},{name:this.id+"_tabindex",value:parseInt(a.index()/2)}],onsuccess:function(g,e,f){PrimeFaces.ajax.Response.handle(g,e,f,{widget:c,handle:function(h){a.html(h);if(this.cfg.cache){this.markAsLoaded(a)}}});return true},oncomplete:function(){c.show(a)}};if(this.hasBehavior("tabChange")){var d=this.cfg.behaviors.tabChange;d.call(this,b)}else{PrimeFaces.ajax.AjaxRequest(b)}},fireTabChangeEvent:function(a){var d=this.cfg.behaviors.tabChange,b={params:[{name:this.id+"_newTab",value:a.attr("id")},{name:this.id+"_tabindex",value:parseInt(a.index()/2)}]};if(this.cfg.controlled){var c=this;b.oncomplete=function(g,e,f){if(f.access&&!f.validationFailed){c.show(a)}}}d.call(this,b)},fireTabCloseEvent:function(b){var a=this.panels.eq(b),d=this.cfg.behaviors.tabClose,c={params:[{name:this.id+"_tabId",value:a.attr("id")},{name:this.id+"_tabindex",value:parseInt(b/2)}]};if(this.cfg.controlled){var e=this;c.oncomplete=function(h,f,g){if(g.access&&!g.validationFailed){e.hide(b)}}}d.call(this,c)},markAsLoaded:function(a){a.data("loaded",true)},isLoaded:function(a){return a.data("loaded")==true},hasBehavior:function(a){if(this.cfg.behaviors){return this.cfg.behaviors[a]!=undefined}return false},addToSelection:function(a){this.cfg.active.push(a)},removeFromSelection:function(a){this.cfg.active=$.grep(this.cfg.active,function(b){return b!=a})},saveState:function(){if(this.cfg.multiple){this.stateHolder.val(this.cfg.active.join(","))}else{this.stateHolder.val(this.cfg.active)}},postTabShow:function(a){if(this.cfg.onTabShow){this.cfg.onTabShow.call(this,a)}PrimeFaces.invokeDeferredRenders(this.id)}});