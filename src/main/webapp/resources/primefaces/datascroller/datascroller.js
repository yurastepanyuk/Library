PrimeFaces.widget.DataScroller=PrimeFaces.widget.BaseWidget.extend({init:function(a){this._super(a);this.content=this.jq.children("div.ui-datascroller-content");this.list=this.content.children("ul");this.loaderContainer=this.content.children("div.ui-datascroller-loader");this.loadStatus=$('<div class="ui-datascroller-loading"></div>');this.loading=false;this.allLoaded=false;this.cfg.offset=0;this.cfg.mode=this.cfg.mode||"document";this.cfg.buffer=(100-this.cfg.buffer)/100;if(this.cfg.loadEvent==="scroll"){this.bindScrollListener()}else{this.loadTrigger=this.loaderContainer.children();this.bindManualLoader()}},bindScrollListener:function(){var d=this;if(this.cfg.mode==="document"){var c=$(window),b=$(document),d=this,a="scroll."+this.id;c.off(a).on(a,function(){if(c.scrollTop()>=((b.height()*d.cfg.buffer)-c.height())&&d.shouldLoad()){d.load()}})}else{this.content.on("scroll",function(){var g=this.scrollTop,f=this.scrollHeight,e=this.clientHeight;if((g>=((f*d.cfg.buffer)-(e)))&&d.shouldLoad()){d.load()}})}},bindManualLoader:function(){var a=this;this.loadTrigger.on("click.dataScroller",function(b){a.load();b.preventDefault()})},load:function(){this.loading=true;this.cfg.offset+=this.cfg.chunkSize;this.loadStatus.appendTo(this.loaderContainer);if(this.loadTrigger){this.loadTrigger.hide()}var b=this,a={source:this.id,process:this.id,update:this.id,global:false,params:[{name:this.id+"_load",value:true},{name:this.id+"_offset",value:this.cfg.offset}],onsuccess:function(e,c,d){PrimeFaces.ajax.Response.handle(e,c,d,{widget:b,handle:function(f){this.list.append(f)}});return true},oncomplete:function(){b.loading=false;b.allLoaded=(b.cfg.offset+b.cfg.chunkSize)>=b.cfg.totalSize;b.loadStatus.remove();if(b.loadTrigger&&!b.allLoaded){b.loadTrigger.show()}}};PrimeFaces.ajax.AjaxRequest(a)},shouldLoad:function(){return(!this.loading&&!this.allLoaded)}});