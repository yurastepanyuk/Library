PrimeFaces.widget.TabView=PrimeFaces.widget.DeferredWidget.extend({init:function(a){this._super(a);this.panelContainer=this.jq.children(".ui-tabs-panels");this.stateHolder=$(this.jqId+"_activeIndex");this.cfg.selected=parseInt(this.stateHolder.val());this.focusedTabHeader=null;this.tabindex=this.cfg.tabindex||0;if(this.cfg.scrollable){this.navscroller=this.jq.children(".ui-tabs-navscroller");this.navcrollerLeft=this.navscroller.children(".ui-tabs-navscroller-btn-left");this.navcrollerRight=this.navscroller.children(".ui-tabs-navscroller-btn-right");this.navContainer=this.navscroller.children(".ui-tabs-nav");this.firstTab=this.navContainer.children(":first-child");this.lastTab=this.navContainer.children(":last-child");this.scrollStateHolder=$(this.jqId+"_scrollState")}else{this.navContainer=this.jq.children(".ui-tabs-nav")}this.bindEvents();if(this.cfg.dynamic&&this.cfg.cache){this.markAsLoaded(this.panelContainer.children().eq(this.cfg.selected))}this.renderDeferred()},renderDeferred:function(){if(this.jq.is(":visible")){this._render()}else{var a=this.jq.parent().closest(".ui-hidden-container"),b=this;if(a.length){this.addDeferredRender(this.id,a,function(){return b.render()})}}},_render:function(){if(this.cfg.scrollable){this.initScrolling()}},bindEvents:function(){var a=this;this.navContainer.children("li").on("mouseover.tabview",function(c){var b=$(this);if(!b.hasClass("ui-state-disabled")){b.addClass("ui-state-hover")}}).on("mouseout.tabview",function(c){var b=$(this);if(!b.hasClass("ui-state-disabled")){b.removeClass("ui-state-hover")}}).on("click.tabview",function(d){var c=$(this);if($(d.target).is(":not(.ui-icon-close)")){var b=c.index();if(!c.hasClass("ui-state-disabled")&&b!==a.cfg.selected){a.select(b)}}d.preventDefault()});this.navContainer.find("li .ui-icon-close").on("click.tabview",function(d){var b=$(this).parent().index();if(a.cfg.onTabClose){var c=a.cfg.onTabClose.call(a,b);if(c!==false){a.remove(b)}}else{a.remove(b)}d.preventDefault()});if(this.cfg.scrollable){this.navscroller.children(".ui-tabs-navscroller-btn").on("mouseover.tabview",function(){var b=$(this);if(!b.hasClass("ui-state-disabled")){$(this).addClass("ui-state-hover")}}).on("mouseout.tabview",function(){var b=$(this);if(!b.hasClass("ui-state-disabled")){$(this).removeClass("ui-state-hover ui-state-active")}}).on("mousedown.tabview",function(){var b=$(this);if(!b.hasClass("ui-state-disabled")){$(this).removeClass("ui-state-hover").addClass("ui-state-active")}}).on("mouseup.tabview",function(){var b=$(this);if(!b.hasClass("ui-state-disabled")){$(this).addClass("ui-state-hover").removeClass("ui-state-active")}}).on("focus.tabview",function(){$(this).addClass("ui-state-focus")}).on("blur.tabview",function(){$(this).removeClass("ui-state-focus")});this.navcrollerLeft.on("click.tabview",function(b){a.scroll(100);b.preventDefault()});this.navcrollerRight.on("click.tabview",function(b){a.scroll(-100);b.preventDefault()})}this.bindKeyEvents()},bindKeyEvents:function(){var b=this,a=this.navContainer.children("li");a.attr("tabindex",this.tabindex);a.on("focus.tabview",function(d){var c=$(this);c.addClass("ui-tabs-outline");if(b.cfg.scrollable){if(c.position().left+c.width()>b.navcrollerRight.position().left){b.navcrollerRight.trigger("click.tabview")}else{if(c.position().left<b.navcrollerLeft.position().left){b.navcrollerLeft.trigger("click.tabview")}}}}).on("blur.tabview",function(){$(this).removeClass("ui-tabs-outline")}).on("keydown.tabview",function(f){var d=$.ui.keyCode,c=f.which;if(c===d.SPACE||c===d.ENTER||c===d.NUMPAD_ENTER){b.select($(this).index());f.preventDefault()}});if(this.cfg.scrollable){this.navcrollerLeft.on("keydown.tabview",function(f){var d=$.ui.keyCode,c=f.which;if(c===d.SPACE||c===d.ENTER||c===d.NUMPAD_ENTER){b.scroll(100);f.preventDefault()}});this.navcrollerRight.on("keydown.tabview",function(f){var d=$.ui.keyCode,c=f.which;if(c===d.SPACE||c===d.ENTER||c===d.NUMPAD_ENTER){b.scroll(-100);f.preventDefault()}})}},initScrolling:function(){if(this.panelContainer.children().length){var a=((this.lastTab.position().left+this.lastTab.width())-this.firstTab.position().left)>this.navscroller.innerWidth();if(a){this.navscroller.css("padding-left","18px");this.navcrollerLeft.attr("tabindex",this.tabindex).show();this.navcrollerRight.attr("tabindex",this.tabindex).show();this.restoreScrollState()}}},scroll:function(c){if(this.navContainer.is(":animated")){return}var f=parseInt(this.navContainer.css("margin-left")),b=f+c,a=this.navscroller.innerWidth(),d=this;if(c<0){var e=this.lastTab.position().left+parseInt(this.lastTab.innerWidth());if(e>a){this.navContainer.animate({"margin-left":b+"px"},"fast","easeInOutCirc",function(){d.saveScrollState(b);if((e+c)<a){d.disableScrollerButton(d.navcrollerRight)}if(d.navcrollerLeft.hasClass("ui-state-disabled")){d.enableScrollerButton(d.navcrollerLeft)}})}}else{if(b<=0){this.navContainer.animate({"margin-left":b+"px"},"fast","easeInOutCirc",function(){d.saveScrollState(b);if(b===0){d.disableScrollerButton(d.navcrollerLeft)}if(d.navcrollerRight.hasClass("ui-state-disabled")){d.enableScrollerButton(d.navcrollerRight)}})}}},disableScrollerButton:function(a){a.addClass("ui-state-disabled").removeClass("ui-state-hover ui-state-active ui-state-focus").attr("tabindex",-1)},enableScrollerButton:function(a){a.removeClass("ui-state-disabled").attr("tabindex",this.tabindex)},saveScrollState:function(a){this.scrollStateHolder.val(a)},restoreScrollState:function(){var a=parseInt(this.scrollStateHolder.val());if(a===0){this.disableScrollerButton(this.navcrollerLeft)}this.navContainer.css("margin-left",this.scrollStateHolder.val()+"px")},select:function(d,c){if(this.cfg.onTabChange&&!c){var a=this.cfg.onTabChange.call(this,d);if(a===false){return false}}var b=this.panelContainer.children().eq(d),e=this.cfg.dynamic&&!this.isLoaded(b);this.stateHolder.val(d);this.cfg.selected=d;if(e){this.loadDynamicTab(b)}else{this.show(b);if(this.hasBehavior("tabChange")&&!c){this.fireTabChangeEvent(b)}}return true},show:function(c){var f=this.navContainer.children(),e=f.filter(".ui-state-active"),b=f.eq(c.index()),d=this.panelContainer.children(".ui-tabs-panel:visible"),a=this;d.attr("aria-hidden",true);e.attr("aria-expanded",false);e.attr("aria-selected",false);c.attr("aria-hidden",false);b.attr("aria-expanded",true);b.attr("aria-selected",true);if(this.cfg.effect){d.hide(this.cfg.effect,null,this.cfg.effectDuration,function(){e.removeClass("ui-tabs-selected ui-state-active");b.addClass("ui-tabs-selected ui-state-active");c.show(a.cfg.effect,null,a.cfg.effectDuration,function(){a.postTabShow(c)})})}else{e.removeClass("ui-tabs-selected ui-state-active");d.hide();b.addClass("ui-tabs-selected ui-state-active");c.show();this.postTabShow(c)}},loadDynamicTab:function(a){var d=this,c=a.index(),b={source:this.id,process:this.id,update:this.id,params:[{name:this.id+"_contentLoad",value:true},{name:this.id+"_newTab",value:a.attr("id")},{name:this.id+"_tabindex",value:c}],onsuccess:function(h,f,g){PrimeFaces.ajax.Response.handle(h,f,g,{widget:d,handle:function(i){a.html(i);if(this.cfg.cache){this.markAsLoaded(a)}}});return true},oncomplete:function(){d.show(a)}};if(this.hasBehavior("tabChange")){var e=this.cfg.behaviors.tabChange;e.call(this,b)}else{PrimeFaces.ajax.Request.handle(b)}},remove:function(d){var h=this.navContainer.children().eq(d),b=this.panelContainer.children().eq(d);h.remove();b.remove();var f=this.getLength();if(f>0){if(d<this.cfg.selected){this.cfg.selected--}else{if(d===this.cfg.selected){var e=(this.cfg.selected===(f))?(this.cfg.selected-1):this.cfg.selected,g=this.navContainer.children("li"),c=g.eq(e);if(c.hasClass("ui-state-disabled")){var a=g.filter(":not(.ui-state-disabled):first");if(a.length){this.select(a.index(),true)}}else{this.select(e,true)}}}}else{this.cfg.selected=-1}this.fireTabCloseEvent(b.attr("id"),d)},getLength:function(){return this.navContainer.children().length},getActiveIndex:function(){return this.cfg.selected},fireTabChangeEvent:function(a){var c=this.cfg.behaviors.tabChange,b={params:[{name:this.id+"_newTab",value:a.attr("id")},{name:this.id+"_tabindex",value:a.index()}]};c.call(this,b)},fireTabCloseEvent:function(d,a){if(this.hasBehavior("tabClose")){var c=this.cfg.behaviors.tabClose,b={params:[{name:this.id+"_closeTab",value:d},{name:this.id+"_tabindex",value:a}]};c.call(this,b)}},hasBehavior:function(a){if(this.cfg.behaviors){return this.cfg.behaviors[a]!==undefined}return false},markAsLoaded:function(a){a.data("loaded",true)},isLoaded:function(a){return a.data("loaded")===true},disable:function(a){this.navContainer.children().eq(a).addClass("ui-state-disabled")},enable:function(a){this.navContainer.children().eq(a).removeClass("ui-state-disabled")},postTabShow:function(a){if(this.cfg.onTabShow){this.cfg.onTabShow.call(this,a.index())}PrimeFaces.invokeDeferredRenders(this.id)}});