PrimeFaces.widget.Tooltip=PrimeFaces.widget.BaseWidget.extend({init:function(a){this.cfg=a;this.id=this.cfg.id;this.cfg.showEvent=this.cfg.showEvent?this.cfg.showEvent+".tooltip":"mouseover.tooltip";this.cfg.hideEvent=this.cfg.hideEvent?this.cfg.hideEvent+".tooltip":"mouseout.tooltip";this.cfg.showEffect=this.cfg.showEffect?this.cfg.showEffect:"fade";this.cfg.hideEffect=this.cfg.hideEffect?this.cfg.hideEffect:"fade";this.cfg.showDelay=this.cfg.showDelay||150;this.cfg.hideDelay=this.cfg.hideDelay||0;this.cfg.hideEffectDuration=this.cfg.target?250:1;this.cfg.position=this.cfg.position||"right";if(this.cfg.target){this.bindTarget()}else{this.bindGlobal()}this.removeScriptElement(this.id)},refresh:function(a){if(a.target){if($(PrimeFaces.escapeClientId(a.id)).length>1){$(document.body).children(PrimeFaces.escapeClientId(a.id)).remove()}}else{$(document.body).children(".ui-tooltip-global").remove()}this._super(a)},bindGlobal:function(){this.jq=$('<div class="ui-tooltip ui-tooltip-global ui-widget ui-tooltip-'+this.cfg.position+'"></div>').appendTo("body");this.jq.append('<div class="ui-tooltip-arrow"></div><div class="ui-tooltip-text ui-shadow ui-corner-all"></div>');this.cfg.globalSelector=this.cfg.globalSelector||"a,:input,:button";this.cfg.escape=(this.cfg.escape===undefined)?true:this.cfg.escape;var b=this;$(document).off(this.cfg.showEvent+" "+this.cfg.hideEvent,this.cfg.globalSelector).on(this.cfg.showEvent,this.cfg.globalSelector,function(d){var c=$(this);if(c.prop("disabled")){return}if(b.cfg.trackMouse){b.mouseEvent=d}var g=c.attr("title");if(g){c.data("tooltip",g).removeAttr("title")}if(c.hasClass("ui-state-error")){b.jq.addClass("ui-state-error")}var f=c.data("tooltip");if(f){if(b.cfg.escape){b.jq.children(".ui-tooltip-text").text(f)}else{b.jq.children(".ui-tooltip-text").html(f)}b.globalTitle=f;b.target=c;b.show()}}).on(this.cfg.hideEvent+".tooltip",this.cfg.globalSelector,function(){if(b.globalTitle){b.hide();b.globalTitle=null;b.target=null;b.jq.removeClass("ui-state-error")}});var a="resize.tooltip";$(window).unbind(a).bind(a,function(){if(b.jq.is(":visible")){b.align()}})},bindTarget:function(){this.id=this.cfg.id;this.jqId=PrimeFaces.escapeClientId(this.id);this.jq=$(this.jqId);this.target=PrimeFaces.expressions.SearchExpressionFacade.resolveComponentsAsSelector(this.cfg.target);var b=this;this.target.off(this.cfg.showEvent+" "+this.cfg.hideEvent).on(this.cfg.showEvent,function(c){if(b.cfg.trackMouse){b.mouseEvent=c}var d=$.trim(b.jq.text());if(b.jq.children().length>0||d!==""){b.show()}}).on(this.cfg.hideEvent+".tooltip",function(){b.hide()});this.jq.appendTo(document.body);if($.trim(this.jq.children(".ui-tooltip-text").html())===""){this.jq.children(".ui-tooltip-text").html(this.target.attr("title"))}this.target.removeAttr("title");var a="resize."+this.id;$(window).unbind(a).bind(a,function(){if(b.jq.is(":visible")){b.align()}})},align:function(){this.jq.css({left:"",top:"","z-index":++PrimeFaces.zindex});if(this.cfg.trackMouse&&this.mouseEvent){this.jq.position({my:"left top+15",at:"right bottom",of:this.mouseEvent,collision:"flipfit"});this.mouseEvent=null}else{var a,b;switch(this.cfg.position){case"right":a="left center";b="right center";break;case"left":a="right center";b="left center";break;case"top":a="center bottom";b="center top";break;case"bottom":a="center top";b="center bottom";break}this.jq.position({my:a,at:b,of:this.target,collision:"flipfit"})}},show:function(){if(this.target){var a=this;this.clearTimeout();this.timeout=setTimeout(function(){a._show()},this.cfg.showDelay)}},_show:function(){var b=this;if(this.cfg.beforeShow){var a=this.cfg.beforeShow.call(this);if(a===false){return}}this.align();if(this.cfg.trackMouse){this.followMouse()}this.jq.show(this.cfg.showEffect,{},250,function(){if(b.cfg.onShow){b.cfg.onShow.call()}})},hide:function(){var a=this;this.clearTimeout();if(this.cfg.hideDelay){this.timeout=setTimeout(function(){a._hide()},this.cfg.hideDelay)}else{this._hide()}},_hide:function(){var a=this;if(this.isVisible()){this.jq.hide(this.cfg.hideEffect,{},this.cfg.hideEffectDuration,function(){$(this).css("z-index","");if(a.cfg.trackMouse){a.unfollowMouse()}if(a.cfg.onHide){a.cfg.onHide.call()}})}},clearTimeout:function(){if(this.timeout){clearTimeout(this.timeout)}},followMouse:function(){var a=this;this.target.on("mousemove.tooltip-track",function(b){a.jq.position({my:"left top+15",at:"right bottom",of:b,collision:"flipfit"})})},unfollowMouse:function(){this.target.off("mousemove.tooltip-track")},isVisible:function(){return this.jq.is(":visible")}});