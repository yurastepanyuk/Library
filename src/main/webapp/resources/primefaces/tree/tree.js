PrimeFaces.widget.BaseTree=PrimeFaces.widget.BaseWidget.extend({init:function(a){this._super(a);this.cfg.highlight=(this.cfg.highlight===false)?false:true;this.focusedNode=null;if(this.cfg.selectionMode){this.initSelection()}this.bindEvents();this.jq.data("widget",this)},initSelection:function(){this.selectionHolder=$(this.jqId+"_selection");var a=this.selectionHolder.val();this.selections=a===""?[]:a.split(",");if(this.isCheckboxSelection()){this.preselectCheckbox()}},expandNode:function(b){var c=this;if(this.cfg.dynamic){if(this.cfg.cache&&c.getNodeChildrenContainer(b).children().length>0){this.showNodeChildren(b);return}if(b.data("processing")){PrimeFaces.debug("Node is already being expanded, ignoring expand event.");return}b.data("processing",true);var a={source:this.id,process:this.id,update:this.id,formId:this.cfg.formId,params:[{name:this.id+"_expandNode",value:c.getRowKey(b)}],onsuccess:function(g,e,f){PrimeFaces.ajax.Response.handle(g,e,f,{widget:c,handle:function(h){var i=this.getNodeChildrenContainer(b);i.append(h);this.showNodeChildren(b);if(this.cfg.draggable){this.makeDraggable(i.find("span.ui-treenode-content"))}if(this.cfg.droppable){this.makeDropPoints(i.find("li.ui-tree-droppoint"));this.makeDropNodes(i.find("span.ui-treenode-droppable"))}}});return true},oncomplete:function(){b.removeData("processing")}};if(this.hasBehavior("expand")){var d=this.cfg.behaviors.expand;d.call(this,a)}else{PrimeFaces.ajax.Request.handle(a)}}else{this.showNodeChildren(b);this.fireExpandEvent(b)}},fireExpandEvent:function(b){if(this.cfg.behaviors){var c=this.cfg.behaviors.expand;if(c){var a={params:[{name:this.id+"_expandNode",value:this.getRowKey(b)}]};c.call(this,a)}}},fireCollapseEvent:function(c){if(this.cfg.behaviors){var a=this.cfg.behaviors.collapse;if(a){var b={params:[{name:this.id+"_collapseNode",value:this.getRowKey(c)}]};a.call(this,b)}}},getNodeChildrenContainer:function(a){throw"Unsupported Operation"},showNodeChildren:function(a){throw"Unsupported Operation"},writeSelections:function(){this.selectionHolder.val(this.selections.join(","))},fireNodeSelectEvent:function(c){if(this.isCheckboxSelection()&&this.cfg.dynamic){var e=this,a={source:this.id,process:this.id};a.params=[{name:this.id+"_instantSelection",value:this.getRowKey(c)}];a.oncomplete=function(k,f,g){if(g.descendantRowKeys&&g.descendantRowKeys!==""){var j=g.descendantRowKeys.split(",");for(var h=0;h<j.length;h++){e.addToSelection(j[h])}e.writeSelections()}};if(this.hasBehavior("select")){var d=this.cfg.behaviors.select;d.call(this,a)}else{PrimeFaces.ajax.AjaxRequest(a)}}else{if(this.hasBehavior("select")){var d=this.cfg.behaviors.select,b={params:[{name:this.id+"_instantSelection",value:this.getRowKey(c)}]};d.call(this,b)}}},fireNodeUnselectEvent:function(c){if(this.cfg.behaviors){var a=this.cfg.behaviors.unselect;if(a){var b={params:[{name:this.id+"_instantUnselection",value:this.getRowKey(c)}]};a.call(this,b)}}},fireContextMenuEvent:function(c){if(this.hasBehavior("contextMenu")){var b=this.cfg.behaviors.contextMenu,a={params:[{name:this.id+"_contextMenuNode",value:this.getRowKey(c)}]};b.call(this,a)}},getRowKey:function(a){return a.attr("data-rowkey")},isNodeSelected:function(a){return $.inArray(this.getRowKey(a),this.selections)!=-1},isSingleSelection:function(){return this.cfg.selectionMode=="single"},isMultipleSelection:function(){return this.cfg.selectionMode=="multiple"},isCheckboxSelection:function(){return this.cfg.selectionMode=="checkbox"},addToSelection:function(a){if(!PrimeFaces.inArray(this.selections,a)){this.selections.push(a)}},removeFromSelection:function(a){this.selections=$.grep(this.selections,function(b){return b!==a})},removeDescendantsFromSelection:function(c){var a=[];for(var b=0;b<this.selections.length;b++){if(this.selections[b].indexOf(c+"_")!==0){a.push(this.selections[b])}}this.selections=a},hasBehavior:function(a){if(this.cfg.behaviors){return this.cfg.behaviors[a]!=undefined}return false},nodeClick:function(f,a){if($(f.target).is(":not(.ui-tree-toggler)")){var e=a.parent(),b=a.hasClass("ui-tree-selectable");if(this.cfg.onNodeClick){this.cfg.onNodeClick.call(this,e,f)}if(b&&this.cfg.selectionMode){var d=this.isNodeSelected(e),g=f.metaKey||f.ctrlKey,c=f.shiftKey;if(this.isCheckboxSelection()){this.toggleCheckboxNode(e)}else{if(d&&(g)){this.unselectNode(e)}else{if(this.isSingleSelection()||(this.isMultipleSelection()&&!g)){this.unselectAllNodes()}this.selectNode(e);this.cursorNode=e}}if($(f.target).is(":not(:input:enabled)")){PrimeFaces.clearSelection();this.focusNode(e)}}}},nodeRightClick:function(e,a){PrimeFaces.clearSelection();if($(e.target).is(":not(.ui-tree-toggler)")){var d=a.parent(),b=a.hasClass("ui-tree-selectable");if(b&&this.cfg.selectionMode){var c=this.isNodeSelected(d);if(!c){if(this.isCheckboxSelection()){this.toggleCheckboxNode(d)}else{this.unselectAllNodes();this.selectNode(d,true)}}this.fireContextMenuEvent(d)}}},bindEvents:function(){throw"Unsupported Operation"},selectNode:function(b,a){throw"Unsupported Operation"},unselectNode:function(b,a){throw"Unsupported Operation"},unselectAllNodes:function(){throw"Unsupported Operation"},preselectCheckbox:function(){throw"Unsupported Operation"},toggleCheckboxNode:function(a){throw"Unsupported Operation"},isEmpty:function(){throw"Unsupported Operation"},toggleCheckboxState:function(b,a){if(a){this.uncheck(b)}else{this.check(b)}},partialCheck:function(d){var b=d.children(".ui-chkbox-box"),a=b.children(".ui-chkbox-icon"),c=d.closest(".ui-treenode"),e=this.getRowKey(c);c.find("> .ui-treenode-content > .ui-treenode-label").removeClass("ui-state-highlight");a.removeClass("ui-icon-blank ui-icon-check").addClass("ui-icon-minus");c.removeClass("ui-treenode-selected ui-treenode-unselected").addClass("ui-treenode-hasselected").attr("aria-checked",false).attr("aria-selected",false);this.removeFromSelection(e)},check:function(d){var b=d.children(".ui-chkbox-box"),a=b.children(".ui-chkbox-icon"),c=d.closest(".ui-treenode"),e=this.getRowKey(c);b.removeClass("ui-state-hover");a.removeClass("ui-icon-blank ui-icon-minus").addClass("ui-icon-check");c.removeClass("ui-treenode-hasselected ui-treenode-unselected").addClass("ui-treenode-selected").attr("aria-checked",true).attr("aria-selected",true);this.addToSelection(e)},uncheck:function(d){var b=d.children(".ui-chkbox-box"),a=b.children(".ui-chkbox-icon"),c=d.closest(".ui-treenode"),e=this.getRowKey(c);b.removeClass("ui-state-hover");a.removeClass("ui-icon-minus ui-icon-check").addClass("ui-icon-blank");c.removeClass("ui-treenode-hasselected ui-treenode-selected").addClass("ui-treenode-unselected").attr("aria-checked",false).attr("aria-selected",false);this.removeFromSelection(e)},isExpanded:function(a){return this.getNodeChildrenContainer(a).is(":visible")},focusNode:function(){throw"Unsupported Operation"}});PrimeFaces.widget.VerticalTree=PrimeFaces.widget.BaseTree.extend({init:function(a){this._super(a);this.container=this.jq.children(".ui-tree-container");this.cfg.rtl=this.jq.hasClass("ui-tree-rtl");this.cfg.collapsedIcon=this.cfg.rtl?"ui-icon-triangle-1-w":"ui-icon-triangle-1-e";if(this.cfg.draggable){this.initDraggable()}if(this.cfg.droppable){this.initDroppable()}},bindEvents:function(){var e=this,b=".ui-tree-toggler",a=".ui-tree-selectable .ui-treenode-label",c=".ui-treenode-content";this.jq.off("click.tree-toggle",b).on("click.tree-toggle",b,null,function(h){var f=$(this),g=f.closest("li");if(f.hasClass(e.cfg.collapsedIcon)){e.expandNode(g)}else{e.collapseNode(g)}});if(this.cfg.highlight&&this.cfg.selectionMode){this.jq.off("mouseout.tree mouseover.tree",a).on("mouseout.tree",a,null,function(){var f=$(this);f.removeClass("ui-state-hover");if(e.isCheckboxSelection()){f.siblings("div.ui-chkbox").children("div.ui-chkbox-box").removeClass("ui-state-hover")}}).on("mouseover.tree",a,null,function(){var f=$(this);$(this).addClass("ui-state-hover");if(e.isCheckboxSelection()){f.siblings("div.ui-chkbox").children("div.ui-chkbox-box").addClass("ui-state-hover")}})}if(this.isCheckboxSelection()){var d=".ui-chkbox-box:not(.ui-state-disabled)";this.jq.off("mouseout.tree-checkbox mouseover.tree-checkbox click.tree-checkbox",d).on("mouseout.tree-checkbox",d,null,function(){$(this).removeClass("ui-state-hover").parent().siblings("span.ui-treenode-label").removeClass("ui-state-hover")}).on("mouseover.tree-checkbox",d,null,function(){$(this).addClass("ui-state-hover").parent().siblings("span.ui-treenode-label").addClass("ui-state-hover")})}this.jq.off("click.tree-content",c).on("click.tree-content",c,null,function(f){e.nodeClick(f,$(this))});this.bindKeyEvents()},bindKeyEvents:function(){var a=this;this.jq.on("mousedown.tree",function(b){if($(b.target).is(":not(:input:enabled)")){b.preventDefault()}}).on("focus.tree",function(){if(!a.focusedNode){a.focusNode(a.getFirstNode())}});this.jq.off("keydown.tree blur.tree",".ui-treenode-label").on("keydown.tree",".ui-treenode-label",null,function(j){if(!a.focusedNode){return}var k="",m=$.ui.keyCode;switch(j.which){case m.LEFT:var d=a.focusedNode.data("rowkey").toString(),n=d.length;if(a.isExpanded(a.focusedNode)){a.collapseNode(a.focusedNode)}else{var f=null;for(var h=1;h<parseInt(n/2)+1;h++){k=d.substring(0,n-2*h);f=a.container.find("li:visible[data-rowkey = '"+k+"']");if(f.length){a.focusNode(f);break}}}j.preventDefault();break;case m.RIGHT:if(!a.focusedNode.hasClass("ui-treenode-leaf")){var d=a.focusedNode.data("rowkey").toString(),n=d.length;if(!a.isExpanded(a.focusedNode)){a.expandNode(a.focusedNode)}if(!a.isExpanded(a.focusedNode)&&!a.cfg.dynamic){k=d+"_0";var f=a.container.find("li:visible[data-rowkey = '"+k+"']");if(f.length){a.focusNode(f)}}}j.preventDefault();break;case m.UP:var f=null,b=a.focusedNode.prev();if(b.length){f=b.find("li.ui-treenode:visible:last");if(!f.length){f=b}}else{f=a.focusedNode.closest("ul").parent("li")}if(f.length){a.focusNode(f)}j.preventDefault();break;case m.DOWN:var f=null,c=a.focusedNode.find("> ul > li:visible:first");if(c.length){f=c}else{if(a.focusedNode.next().length){f=a.focusedNode.next()}else{var d=a.focusedNode.data("rowkey").toString();if(d.length!==1){f=a.searchDown(a.focusedNode)}}}if(f&&f.length){a.focusNode(f)}j.preventDefault();break;case m.ENTER:case m.NUMPAD_ENTER:case m.SPACE:if(a.cfg.selectionMode){var l=a.focusedNode.children(".ui-treenode-content").hasClass("ui-tree-selectable");if(a.cfg.onNodeClick){a.cfg.onNodeClick.call(a,a.focusedNode,j)}if(l){var g=a.isNodeSelected(a.focusedNode);if(a.isCheckboxSelection()){a.toggleCheckboxNode(a.focusedNode)}else{if(g){a.unselectNode(a.focusedNode)}else{if(a.isSingleSelection()){a.unselectAllNodes()}a.selectNode(a.focusedNode);a.cursorNode=a.focusedNode}}}}j.preventDefault();break}}).on("blur.tree",".ui-treenode-label",null,function(b){if(a.focusedNode){a.getNodeLabel(a.focusedNode).removeClass("ui-treenode-outline");a.focusedNode=null}})},bindContextMenu:function(e,f,d,a){var c=d+" .ui-tree-selectable",b=a.nodeType?a.event+".treenode."+a.nodeType:a.event+".treenode",g=a.event+".tree";$(document).off(b,c).on(b,c,null,function(i){var h=$(this);if(a.nodeType===undefined||h.parent().data("nodetype")===a.nodeType){f.nodeRightClick(i,h);e.show(i)}});$(document).off(g,this.jqTargetId).on(g,this.jqTargetId,null,function(h){if(f.isEmpty()){e.show(h)}})},searchDown:function(d){var b=d.closest("ul").parent("li").next(),a=null;if(b.length){a=b}else{if(d.hasClass("ui-treenode-leaf")&&d.closest("ul").parent("li").length==0){a=d}else{var c=d.data("rowkey").toString();if(c.length!==1){a=this.searchDown(d.closest("ul").parent("li"))}}}return a},collapseNode:function(h){var b=this,e=h.find("> .ui-treenode-content"),g=e.find("> .ui-tree-toggler"),d=h.data("nodetype"),c=g.nextAll("span.ui-treenode-icon"),a=this.cfg.iconStates[d],f=h.children(".ui-treenode-children");e.find("> .ui-treenode-label").attr("aria-expanded",false);g.addClass(b.cfg.collapsedIcon).removeClass("ui-icon-triangle-1-s");if(a){c.removeClass(a.expandedIcon).addClass(a.collapsedIcon)}if(this.cfg.animate){f.slideUp("fast",function(){b.postCollapse(h,f)})}else{f.hide();this.postCollapse(h,f)}},postCollapse:function(b,a){if(this.cfg.dynamic&&!this.cfg.cache){a.empty()}this.fireCollapseEvent(b)},getNodeChildrenContainer:function(a){return a.children(".ui-treenode-children")},showNodeChildren:function(f){var d=f.find("> .ui-treenode-content"),e=d.find("> .ui-tree-toggler"),c=f.data("nodetype"),b=e.nextAll("span.ui-treenode-icon"),a=this.cfg.iconStates[c];d.find("> .ui-treenode-label").attr("aria-expanded",true);e.addClass("ui-icon-triangle-1-s").removeClass(this.cfg.collapsedIcon);if(a){b.removeClass(a.collapsedIcon).addClass(a.expandedIcon)}if(this.cfg.animate){f.children(".ui-treenode-children").slideDown("fast")}else{f.children(".ui-treenode-children").show()}},unselectAllNodes:function(){this.selections=[];this.jq.find(".ui-treenode-label.ui-state-highlight").each(function(){$(this).removeClass("ui-state-highlight").closest(".ui-treenode").attr("aria-selected",false)})},selectNode:function(b,a){b.attr("aria-selected",true).find("> .ui-treenode-content > .ui-treenode-label").removeClass("ui-state-hover").addClass("ui-state-highlight");this.addToSelection(this.getRowKey(b));this.writeSelections();if(!a){this.fireNodeSelectEvent(b)}},unselectNode:function(b,a){var c=this.getRowKey(b);b.attr("aria-selected",false).find("> .ui-treenode-content > .ui-treenode-label").removeClass("ui-state-highlight ui-state-hover");this.removeFromSelection(c);this.writeSelections();if(!a){this.fireNodeUnselectEvent(b)}},toggleCheckboxNode:function(b){var d=this,c=b.find("> .ui-treenode-content > .ui-chkbox"),a=c.find("> .ui-chkbox-box > .ui-chkbox-icon").hasClass("ui-icon-check");this.toggleCheckboxState(c,a);if(this.cfg.propagateDown){b.children(".ui-treenode-children").find(".ui-chkbox").each(function(){d.toggleCheckboxState($(this),a)});if(this.cfg.dynamic){this.removeDescendantsFromSelection(b.data("rowkey"))}}if(this.cfg.propagateUp){b.parents("li.ui-treenode-parent").each(function(){var e=$(this),f=e.find("> .ui-treenode-content > .ui-chkbox"),g=e.find("> .ui-treenode-children > .ui-treenode");if(a){if(g.filter(".ui-treenode-unselected").length===g.length){d.uncheck(f)}else{d.partialCheck(f)}}else{if(g.filter(".ui-treenode-selected").length===g.length){d.check(f)}else{d.partialCheck(f)}}})}this.writeSelections();if(a){this.fireNodeUnselectEvent(b)}else{this.fireNodeSelectEvent(b)}},preselectCheckbox:function(){this.jq.find(".ui-chkbox-icon").not(".ui-icon-check").each(function(){var a=$(this),b=a.closest("li");if(b.children(".ui-treenode-children").find(".ui-chkbox-icon.ui-icon-check").length>0){b.addClass("ui-treenode-hasselected");a.removeClass("ui-icon-blank").addClass("ui-icon-minus")}})},check:function(a){this._super(a);a.siblings("span.ui-treenode-label").addClass("ui-state-highlight").removeClass("ui-state-hover")},uncheck:function(a){this._super(a);a.siblings("span.ui-treenode-label").removeClass("ui-state-highlight")},initDraggable:function(){this.makeDraggable(this.jq.find("span.ui-treenode-content"))},initDroppable:function(){this.makeDropPoints(this.jq.find("li.ui-tree-droppoint"));this.makeDropNodes(this.jq.find("span.ui-treenode-droppable"));this.initDropScrollers()},makeDraggable:function(b){var c=this,a=this.cfg.dragdropScope||this.id;b.draggable({helper:function(){var d=$('<div class="ui-tree-draghelper ui-state-highlight"></div>');d.width(c.jq.width());d.height(20);return d},appendTo:document.body,zIndex:++PrimeFaces.zindex,revert:true,scope:a}).data({dragsourceid:this.jqId,dragmode:this.cfg.dragMode})},makeDropPoints:function(b){var c=this,a=this.cfg.dragdropScope||this.id;b.droppable({hoverClass:"ui-state-hover",accept:"span.ui-treenode-content",tolerance:"pointer",scope:a,drop:function(e,n){var f=$(n.draggable.data("dragsourceid")).data("widget"),m=n.draggable.data("dragmode"),l=c,p=$(this),o=p.closest("li.ui-treenode-parent"),q=c.getRowKey(o),i=n.draggable.closest("li.ui-treenode"),g=c.findTargetDragNode(i,m),k=c.getRowKey(g),d=g.next("li.ui-tree-droppoint"),r=g.parent().closest("li.ui-treenode-parent"),h=(f.id!==l.id);n.helper.remove();p.removeClass("ui-state-hover");var j=c.validateDropPoint(i,p);if(!j){return}g.hide().insertAfter(p);if(h){if(f.cfg.selectionMode){f.unselectSubtree(g)}d.remove();c.updateDragDropBindings(g)}else{d.insertAfter(g)}if(r.length&&(r.find("> ul.ui-treenode-children > li.ui-treenode").length===0)){c.makeLeaf(r)}g.fadeIn();if(c.isCheckboxSelection()){c.syncDNDCheckboxes(f,r,o)}c.syncDragDrop();if(h){f.syncDragDrop()}c.fireDragDropEvent({dragNodeKey:k,dropNodeKey:q,dragSource:f.id,dndIndex:p.prevAll("li.ui-treenode").length,transfer:h})}})},makeDropNodes:function(b){var c=this,a=this.cfg.dragdropScope||this.id;b.droppable({accept:".ui-treenode-content",tolerance:"pointer",scope:a,over:function(d,e){$(this).children(".ui-treenode-label").addClass("ui-state-hover")},out:function(d,e){$(this).children(".ui-treenode-label").removeClass("ui-state-hover")},drop:function(e,o){var f=$(o.draggable.data("dragsourceid")).data("widget"),m=o.draggable.data("dragmode"),l=c,n=$(this),p=n.closest("li.ui-treenode"),r=c.getRowKey(p),i=o.draggable.closest("li.ui-treenode"),g=c.findTargetDragNode(i,m),k=c.getRowKey(g),d=g.next("li.ui-tree-droppoint"),s=g.parent().closest("li.ui-treenode-parent"),q=p.children(".ui-treenode-children"),h=(f.id!==l.id);o.helper.remove();n.children(".ui-treenode-label").removeClass("ui-state-hover");var j=c.validateDropNode(i,p,s);if(!j){return}if(q.children("li.ui-treenode").length===0){c.makeParent(p)}g.hide();q.append(g);if(s.length&&(s.find("> ul.ui-treenode-children > li.ui-treenode").length===0)){c.makeLeaf(s)}if(h){if(f.cfg.selectionMode){f.unselectSubtree(g)}d.remove();c.updateDragDropBindings(g)}else{q.append(d)}g.fadeIn();if(c.isCheckboxSelection()){c.syncDNDCheckboxes(f,s,p)}c.syncDragDrop();if(h){f.syncDragDrop()}c.fireDragDropEvent({dragNodeKey:k,dropNodeKey:r,dragSource:f.id,dndIndex:g.prevAll("li.ui-treenode").length,transfer:h})}})},initDropScrollers:function(){var b=this,a=this.cfg.dragdropScope||this.id;this.jq.prepend('<div class="ui-tree-scroller ui-tree-scrollertop"></div>').append('<div class="ui-tree-scroller ui-tree-scrollerbottom"></div>');this.jq.children("div.ui-tree-scroller").droppable({accept:".ui-treenode-content",tolerance:"pointer",scope:a,over:function(){var c=$(this).hasClass("ui-tree-scrollertop")?-10:10;b.scrollInterval=setInterval(function(){b.scroll(c)},100)},out:function(){clearInterval(b.scrollInterval)}})},scroll:function(a){this.container.scrollTop(this.container.scrollTop()+a)},updateDragDropBindings:function(c){c.after('<li class="ui-tree-droppoint ui-droppable"></li>');this.makeDropPoints(c.next("li.ui-tree-droppoint"));var b=c.find("li.ui-tree-droppoint");b.droppable("destroy");this.makeDropPoints(b);var a=c.find("span.ui-treenode-content");a.droppable("destroy");this.makeDropNodes(a);if(this.cfg.draggable){a.data({dragsourceid:this.jqId,dragmode:this.cfg.dragMode})}},findTargetDragNode:function(b,c){var a=null;if(c==="self"){a=b}else{if(c==="parent"){a=b.parent().closest("li.ui-treenode")}else{if(c==="ancestor"){a=b.parent().parents("li.ui-treenode:last")}}}if(a.length===0){a=b}return a},findNodes:function(c){var a=[];for(var b=0;b<c.length;b++){a.push($(this.jqId+"\\:"+c[b]))}return a},updateRowKeys:function(){var a=this.jq.find("> ul.ui-tree-container > li.ui-treenode");this.updateChildrenRowKeys(a,null)},updateChildrenRowKeys:function(b,a){var c=this;b.each(function(f){var e=$(this),g=e.attr("data-rowkey"),d=(a===null)?f.toString():a+"_"+f;e.attr({id:c.id+":"+d,"data-rowkey":d});if(e.hasClass("ui-treenode-parent")){c.updateChildrenRowKeys(e.find("> ul.ui-treenode-children > li.ui-treenode"),d)}})},validateDropPoint:function(a,b){if(a.next().get(0)===b.get(0)||a.prev().get(0)===b.get(0)){return false}if(a.has(b.get(0)).length){return false}if(this.cfg.dropRestrict){if(this.cfg.dropRestrict==="sibling"&&a.parent().get(0)!==b.parent().get(0)){return false}}return true},validateDropNode:function(c,b,a){if(a.get(0)===b.get(0)){return false}if(c.has(b.get(0)).length){return false}if(this.cfg.dropRestrict){if(this.cfg.dropRestrict==="sibling"){return false}}return true},makeLeaf:function(a){a.removeClass("ui-treenode-parent").addClass("ui-treenode-leaf");a.find("> .ui-treenode-content > .ui-tree-toggler").addClass("ui-treenode-leaf-icon").removeClass("ui-tree-toggler ui-icon ui-icon-triangle-1-s");a.children(".ui-treenode-children").hide().children().remove()},makeParent:function(a){a.removeClass("ui-treenode-leaf").addClass("ui-treenode-parent");a.find("> span.ui-treenode-content > span.ui-treenode-leaf-icon").removeClass("ui-treenode-leaf-icon").addClass("ui-tree-toggler ui-icon ui-icon-triangle-1-e");a.children(".ui-treenode-children").append('<li class="ui-tree-droppoint ui-droppable"></li>');this.makeDropPoints(a.find("> ul.ui-treenode-children > li.ui-tree-droppoint"))},syncDragDrop:function(){var a=this;if(this.cfg.selectionMode){var b=this.findNodes(this.selections);this.updateRowKeys();this.selections=[];$.each(b,function(c,d){a.selections.push(d.attr("data-rowkey"))});this.writeSelections()}else{this.updateRowKeys()}},syncDNDCheckboxes:function(a,b,c){if(b.length){a.propagateDNDCheckbox(b)}if(c.length){this.propagateDNDCheckbox(c)}},unselectSubtree:function(a){var c=this;if(this.isCheckboxSelection()){var b=a.find("> .ui-treenode-content > .ui-chkbox");this.toggleCheckboxState(b,true);a.children(".ui-treenode-children").find(".ui-chkbox").each(function(){c.toggleCheckboxState($(this),true)})}else{a.find(".ui-treenode-label.ui-state-highlight").each(function(){$(this).removeClass("ui-state-highlight").closest("li.ui-treenode").attr("aria-selected",false)})}},propagateDNDCheckbox:function(c){var d=c.find("> .ui-treenode-content > .ui-chkbox"),a=c.find("> .ui-treenode-children > .ui-treenode");if(a.length){if(a.filter(".ui-treenode-unselected").length===a.length){this.uncheck(d)}else{if(a.filter(".ui-treenode-selected").length===a.length){this.check(d)}else{this.partialCheck(d)}}}var b=c.parent().closest(".ui-treenode-parent");if(b.length){this.propagateDNDCheckbox(b)}},fireDragDropEvent:function(c){var d=this,b={source:this.id,process:c.transfer?this.id+" "+c.dragSource:this.id};b.params=[{name:this.id+"_dragdrop",value:true},{name:this.id+"_dragNode",value:c.dragNodeKey},{name:this.id+"_dragSource",value:c.dragSource},{name:this.id+"_dropNode",value:c.dropNodeKey},{name:this.id+"_dndIndex",value:c.dndIndex}];if(this.hasBehavior("dragdrop")){var a=this.cfg.behaviors.dragdrop;a.call(this,b)}else{PrimeFaces.ajax.AjaxRequest(b)}},isEmpty:function(){return(this.container.children().length===0)},getFirstNode:function(){return this.jq.find("> ul.ui-tree-container > li:first-child")},getNodeLabel:function(a){return a.find("> span.ui-treenode-content > span.ui-treenode-label")},focusNode:function(a){if(this.focusedNode){this.getNodeLabel(this.focusedNode).removeClass("ui-treenode-outline")}this.getNodeLabel(a).addClass("ui-treenode-outline").focus();this.focusedNode=a}});PrimeFaces.widget.HorizontalTree=PrimeFaces.widget.BaseTree.extend({init:function(a){this._super(a);if(PrimeFaces.isIE()){this.drawConnectors()}},bindEvents:function(){var c=this,d=this.cfg.selectionMode,a=".ui-tree-toggler",b=".ui-treenode-content.ui-tree-selectable";this.jq.off("click.tree-toggle",a).on("click.tree-toggle",a,null,function(){var e=$(this),f=e.closest("td.ui-treenode");if(f.hasClass("ui-treenode-collapsed")){c.expandNode(f)}else{c.collapseNode(f)}});if(d&&this.cfg.highlight){this.jq.off("mouseout.tree mouseover.tree",b).on("mouseover.tree",b,null,function(){var e=$(this);if(!e.hasClass("ui-state-highlight")){e.addClass("ui-state-hover");if(c.isCheckboxSelection()){e.children("div.ui-chkbox").children("div.ui-chkbox-box").addClass("ui-state-hover")}}}).on("mouseout.tree",b,null,function(){var e=$(this);if(!e.hasClass("ui-state-highlight")){e.removeClass("ui-state-hover");if(c.isCheckboxSelection()){e.children("div.ui-chkbox").children("div.ui-chkbox-box").removeClass("ui-state-hover")}}})}this.jq.off("click.tree-content",b).on("click.tree-content",b,null,function(f){c.nodeClick(f,$(this))})},showNodeChildren:function(e){e.attr("aria-expanded",true);var c=e.next(),d=e.find("> .ui-treenode-content > .ui-tree-toggler"),b=e.data("nodetype"),a=this.cfg.iconStates[b];if(a){d.nextAll("span.ui-treenode-icon").removeClass(a.collapsedIcon).addClass(a.expandedIcon)}d.addClass("ui-icon-minus").removeClass("ui-icon-plus");e.removeClass("ui-treenode-collapsed");c.show();if($.browser.msie){this.drawConnectors()}},collapseNode:function(e){var c=e.next(),d=e.find("> .ui-treenode-content > .ui-tree-toggler"),b=e.data("nodetype"),a=this.cfg.iconStates[b];if(a){d.nextAll("span.ui-treenode-icon").addClass(a.collapsedIcon).removeClass(a.expandedIcon)}d.removeClass("ui-icon-minus").addClass("ui-icon-plus");e.addClass("ui-treenode-collapsed");c.hide();if(this.cfg.dynamic&&!this.cfg.cache){c.children(".ui-treenode-children").empty()}this.fireCollapseEvent(e);if($.browser.msie){this.drawConnectors()}},getNodeChildrenContainer:function(a){return a.next(".ui-treenode-children-container").children(".ui-treenode-children")},selectNode:function(b,a){b.removeClass("ui-treenode-unselected").addClass("ui-treenode-selected").children(".ui-treenode-content").removeClass("ui-state-hover").addClass("ui-state-highlight");this.addToSelection(this.getRowKey(b));this.writeSelections();if(!a){this.fireNodeSelectEvent(b)}},unselectNode:function(b,a){var c=this.getRowKey(b);b.removeClass("ui-treenode-selected").addClass("ui-treenode-unselected").children(".ui-treenode-content").removeClass("ui-state-highlight");this.removeFromSelection(c);this.writeSelections();if(!a){this.fireNodeUnselectEvent(b)}},unselectAllNodes:function(){this.selections=[];this.jq.find(".ui-treenode-content.ui-state-highlight").each(function(){$(this).removeClass("ui-state-highlight").closest(".ui-treenode").attr("aria-selected",false)})},preselectCheckbox:function(){var a=this;this.jq.find(".ui-chkbox-icon").not(".ui-icon-check").each(function(){var c=$(this),d=c.closest(".ui-treenode"),b=a.getNodeChildrenContainer(d);if(b.find(".ui-chkbox-icon.ui-icon-check").length>0){c.removeClass("ui-icon-blank").addClass("ui-icon-minus")}})},toggleCheckboxNode:function(b){var d=this,c=b.find("> .ui-treenode-content > .ui-chkbox"),a=c.find("> .ui-chkbox-box > .ui-chkbox-icon").hasClass("ui-icon-check");this.toggleCheckboxState(c,a);if(this.cfg.propagateDown){b.next(".ui-treenode-children-container").find(".ui-chkbox").each(function(){d.toggleCheckboxState($(this),a)});if(this.cfg.dynamic){this.removeDescendantsFromSelection(b.data("rowkey"))}}if(this.cfg.propagateUp){b.parents("td.ui-treenode-children-container").each(function(){var f=$(this),e=f.prev(".ui-treenode-parent"),g=e.find("> .ui-treenode-content > .ui-chkbox"),h=f.find("> .ui-treenode-children > table > tbody > tr > td.ui-treenode");if(a){if(h.filter(".ui-treenode-unselected").length===h.length){d.uncheck(g)}else{d.partialCheck(g)}}else{if(h.filter(".ui-treenode-selected").length===h.length){d.check(g)}else{d.partialCheck(g)}}})}this.writeSelections();if(a){this.fireNodeUnselectEvent(b)}else{this.fireNodeSelectEvent(b)}},check:function(a){this._super(a);a.parent(".ui-treenode-content").addClass("ui-state-highlight").removeClass("ui-state-hover")},uncheck:function(a){this._super(a);a.parent(".ui-treenode-content").removeClass("ui-state-highlight")},drawConnectors:function(){this.jq.find("table.ui-treenode-connector-table").each(function(){var a=$(this);a.height(0).height(a.parent().height())})},isEmpty:function(){return this.jq.children("table").length===0},focusNode:function(a){},partialCheck:function(d){var b=d.children(".ui-chkbox-box"),a=b.children(".ui-chkbox-icon"),c=d.closest(".ui-treenode"),e=this.getRowKey(c);c.find("> .ui-treenode-content").removeClass("ui-state-highlight");a.removeClass("ui-icon-blank ui-icon-check").addClass("ui-icon-minus");c.removeClass("ui-treenode-selected ui-treenode-unselected").addClass("ui-treenode-hasselected").attr("aria-checked",false).attr("aria-selected",false);this.removeFromSelection(e)}});